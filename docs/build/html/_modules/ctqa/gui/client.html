

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ctqa.gui.client &mdash; CTQA 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> CTQA
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">CTQA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>ctqa.gui.client</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for ctqa.gui.client</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">CTQA Client Module</span>

<span class="sd">Contains logic for implementing the CTQA Client with the ctqa_client class.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="k">import</span> <span class="n">ttk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="k">import</span> <span class="n">Toplevel</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="k">import</span> <span class="n">messagebox</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageTk</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">deque</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">servicemanager</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">reportutil</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">profileutil</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">profileclient</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">configclient</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">notificationsclient</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">logwatcher</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">confutil</span>
<span class="kn">import</span> <span class="nn">win32com.client</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">logutil</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logutil</span><span class="o">.</span><span class="n">MAIN_LOG_NAME</span><span class="p">)</span>


<div class="viewcode-block" id="resource_path"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.resource_path">[docs]</a><span class="k">def</span> <span class="nf">resource_path</span><span class="p">(</span><span class="n">relative_path</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;_MEIPASS&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_MEIPASS</span><span class="p">,</span> <span class="n">relative_path</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span> <span class="n">relative_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client">[docs]</a><span class="k">class</span> <span class="nc">ctqa_client</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;CTQA client class. Contains logic to instantiate inside a passed Tkinter parent element.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">minsize</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s1">&#39;750x500&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CTQA Client&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">img</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">resource_path</span><span class="p">(</span><span class="s1">&#39;res/ctqa-icon.gif&#39;</span><span class="p">))</span>
      <span class="n">parent</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">&#39;wm&#39;</span><span class="p">,</span> <span class="s1">&#39;iconphoto&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">tk</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>
      <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ERROR: Could not load ctqa-icon.gif from resources folder&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="s1">&#39;ctqa.log&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">confpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="s1">&#39;config.json&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">profilepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="s1">&#39;profiles.json&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reportspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="s1">&#39;reports&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">confutil</span><span class="o">.</span><span class="n">loadConfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confpath</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">profileutil</span><span class="o">.</span><span class="n">openProfiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profilepath</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm_style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Main.TFrame&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;Main.TFrame&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">))</span>

    <span class="c1"># Menubar</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">createMenubar</span><span class="p">()</span>

    <span class="c1"># Report section</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">createReportList</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">createReportElements</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">createLogElements</span><span class="p">()</span>

    <span class="c1">#Service section</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">createServiceDisplay</span><span class="p">()</span>

    <span class="c1"># Weighting elements for resizing</span>
    <span class="c1"># Col/Rows of Root</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Cols of Main Frame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># Rows of Main Frame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="o">.</span><span class="n">rowconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="o">.</span><span class="n">rowconfigure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-topmost&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

  
<div class="viewcode-block" id="ctqa_client.createMenubar"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.createMenubar">[docs]</a>  <span class="k">def</span> <span class="nf">createMenubar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">menubar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>

    <span class="c1"># Create CTQA pulldown menu</span>
    <span class="n">filemenu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">filemenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
    <span class="n">menubar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;CTQA&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">filemenu</span><span class="p">)</span>

    <span class="c1"># Create Reports pulldown menu</span>
    <span class="c1"># Daily report regen</span>
    <span class="n">editmenu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">editmenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Regenerate Daily Reports&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">reportutil</span><span class="o">.</span><span class="n">regenerateReports</span><span class="p">(</span>
      <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">),</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span>
    <span class="p">))</span>
    <span class="c1"># Weekly report regen</span>
    <span class="n">menubar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">editmenu</span><span class="p">)</span>
    <span class="n">editmenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Regenerate Weekly Reports&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">reportutil</span><span class="o">.</span><span class="n">regenerateReports</span><span class="p">(</span>
      <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">),</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">,</span>
      <span class="n">report_type</span><span class="o">=</span><span class="s2">&quot;weekly&quot;</span>
    <span class="p">))</span>
    <span class="n">menubar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">editmenu</span><span class="p">)</span>

    <span class="c1"># Display menu</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="n">menubar</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.createReportList"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.createReportList">[docs]</a>  <span class="k">def</span> <span class="nf">createReportList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repframe</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repframe</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repframe</span><span class="p">,</span> <span class="n">selectmode</span><span class="o">=</span><span class="s1">&#39;browse&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">repscroll</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repframe</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repscroll</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">repscroll</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;headings&#39;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

    <span class="c1">#Header names with sort code</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
      <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Report Name&#39;</span><span class="p">,</span>
      <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeview_sort_column</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span>
      <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Last Updated&#39;</span><span class="p">,</span>
      <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeview_sort_column</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">populate_report_list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">watch_reports_folder</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Double-Button-1&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_report</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.createReportElements"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.createReportElements">[docs]</a>  <span class="k">def</span> <span class="nf">createReportElements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rlblframe</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#2f3f54&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rlbl</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rlblframe</span><span class="p">,</span>
      <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Reports&#39;</span><span class="p">,</span>
      <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;#e3e9f0&#39;</span><span class="p">,</span>
      <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#2f3f54&#39;</span><span class="p">,</span>
      <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rlbl</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rOpen</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Open Reports Folder&#39;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#e6e6e6&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_reports_folder</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rView</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;View Report&#39;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#e6e6e6&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_report</span><span class="p">)</span>
    <span class="c1">#Adding to grid</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repframe</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rlblframe</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rOpen</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">),</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rView</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">),</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.createServiceDisplay"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.createServiceDisplay">[docs]</a>  <span class="k">def</span> <span class="nf">createServiceDisplay</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Creating settings title bar</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#2f3f54&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slbl</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sFrame</span><span class="p">,</span>
      <span class="n">text</span><span class="o">=</span><span class="s1">&#39;CTQA Audit&#39;</span><span class="p">,</span>
      <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;#e3e9f0&#39;</span><span class="p">,</span>
      <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#2f3f54&#39;</span><span class="p">,</span>
      <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slbl</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sFrame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

    <span class="c1">#Creating the frame for all ctqa-service settings/config controls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settingsFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">SUNKEN</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settingsFrame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
      <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
      <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
      <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
      <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">),</span>
      <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
      <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Creating CTQA Service status</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">statusFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsFrame</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">130</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">SUNKEN</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#ccc&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">statusFrame</span><span class="o">.</span><span class="n">pack_propagate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">statusFrame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">statImg</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">resource_path</span><span class="p">(</span><span class="s1">&#39;res/service-unreg.gif&#39;</span><span class="p">))</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">statImgTk</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">statImg</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
      <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ERROR: Could not load service-unreg.gif from resources folder&quot;</span><span class="p">)</span>

    <span class="c1">#Fetching Source status</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
      <span class="n">srcres</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">srcres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">)</span>

    <span class="c1"># Source status</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sourcestatus</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">statusFrame</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Source: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">srcres</span><span class="p">),</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;#ccc&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sourcestatus</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

    <span class="c1"># Creating CTQA config buttons frame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsFrame</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configFrame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Creating CTQA config buttons</span>
    <span class="c1"># Start service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceControl</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Notifications&quot;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_credentials_client</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceControl</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="c1"># Service (un)install</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ServicesInstalled&quot;</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">configServiceInst</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Install Service&quot;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_install</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">configServiceInst</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">configServiceInst</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Uninstall Service&quot;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_uninstall</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">configServiceInst</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="c1"># Manual Run</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceRun</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Manual Audit&quot;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">manual_audit</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceRun</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="c1"># Edit Config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceConfig</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Edit Config&quot;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_config_client</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceConfig</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="c1"># Manage QA Profiles</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceProfiles</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Manage QA Profiles&quot;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_profile_client</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceProfiles</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.createLogElements"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.createLogElements">[docs]</a>  <span class="k">def</span> <span class="nf">createLogElements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Creating log frame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainfrm</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">SUNKEN</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lFrame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
      <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
      <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
      <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
      <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
      <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">),</span>
      <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Creating log title bar</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">llblFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lFrame</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#2f3f54&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">llblFrame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">llbl</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">llblFrame</span><span class="p">,</span>
      <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Logs&#39;</span><span class="p">,</span>
      <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;#e3e9f0&#39;</span><span class="p">,</span>
      <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#2f3f54&#39;</span><span class="p">,</span>
      <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">llbl</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># Log Button frame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logButtonFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lFrame</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logButtonFrame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">openLogButton</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logButtonFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Open Log&#39;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_log</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">openLogFolderButton</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logButtonFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Open Log Folder&#39;</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;#ddd&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_log_folder</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">openLogFolderButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">openLogButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Textbox + scrollbar in logTextFrame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logTextFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lFrame</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;#ffffff&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logTextFrame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logTextScrollY</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logTextFrame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logTextScrollY</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logTextScrollX</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logTextFrame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logTextScrollX</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logText</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logTextFrame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
      <span class="n">xscrollcommand</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logTextScrollX</span><span class="o">.</span><span class="n">set</span><span class="p">,</span>
      <span class="n">yscrollcommand</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logTextScrollY</span><span class="o">.</span><span class="n">set</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">logTextScrollX</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">xview</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logTextScrollY</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>

    <span class="c1"># Adding log watcher, whether or not log exists</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_log_watcher</span><span class="p">()</span>
    
    <span class="c1"># Adding log contents if log exists</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logpath</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">load_log_contents</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span> <span class="c1"># Scrolling to bottom of textbox</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="s1">&#39;Log either does not exist yet or could not be found.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ctqa_client.treeview_sort_column"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.treeview_sort_column">[docs]</a>  <span class="k">def</span> <span class="nf">treeview_sort_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tv</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">reverse</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[(</span><span class="n">tv</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">col</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tv</span><span class="o">.</span><span class="n">get_children</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)]</span>
    <span class="n">l</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>

    <span class="c1"># rearrange items in sorted positions</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="n">tv</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

    <span class="c1"># reverse sort next time</span>
    <span class="n">tv</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">treeview_sort_column</span><span class="p">(</span><span class="n">tv</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="ow">not</span> <span class="n">reverse</span><span class="p">))</span></div>

  
<div class="viewcode-block" id="ctqa_client.checkForFolder"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.checkForFolder">[docs]</a>  <span class="k">def</span> <span class="nf">checkForFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">folderExists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">folderExists</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">path</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; Error&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; folder does not exist at location:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
      <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="ctqa_client.populate_report_list"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.populate_report_list">[docs]</a>  <span class="k">def</span> <span class="nf">populate_report_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">reportsFolder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reportspath</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reportsFolder</span><span class="p">:</span>
      <span class="n">pngs</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reportspath</span> <span class="o">+</span> <span class="s1">&#39;/*.png&#39;</span><span class="p">):</span>
        <span class="n">fileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">mTime</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">pngs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">fileName</span><span class="p">,</span> <span class="n">mTime</span><span class="p">])</span>
      
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pngs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Audit Report&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Reports folder is empty&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Iterates over name/unix timestamp from iterated pngs and inserts into replist</span>
        <span class="k">for</span> <span class="n">png</span> <span class="ow">in</span> <span class="n">pngs</span><span class="p">:</span>
          <span class="n">mTime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">png</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Audit Report&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="n">png</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mTime</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Audit Report&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Could not open reports folder&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="ctqa_client.refresh_report"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.refresh_report">[docs]</a>  <span class="k">def</span> <span class="nf">refresh_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">replist</span><span class="o">.</span><span class="n">get_children</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">populate_report_list</span><span class="p">()</span></div>

  <span class="c1"># Watches for name/time changes and updates folder</span>
<div class="viewcode-block" id="ctqa_client.watch_reports_folder"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.watch_reports_folder">[docs]</a>  <span class="k">def</span> <span class="nf">watch_reports_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">watchReports</span><span class="p">():</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Started watching reports folder&#39;</span><span class="p">)</span>
      <span class="n">oldReports</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">repFolderExists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reportspath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">repFolderExists</span><span class="p">:</span>
          <span class="n">reports</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reportspath</span> <span class="o">+</span> <span class="s1">&#39;/*.png&#39;</span><span class="p">)</span>
          <span class="n">newReports</span> <span class="o">=</span> <span class="p">[]</span>
          <span class="k">for</span> <span class="n">report</span> <span class="ow">in</span> <span class="n">reports</span><span class="p">:</span> <span class="c1"># Detecting time created change</span>
            <span class="k">try</span><span class="p">:</span>
              <span class="n">newReports</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">report</span><span class="p">)</span> 
              <span class="n">newReports</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">report</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span> <span class="c1"># In case the user saves over the old report</span>
              <span class="n">oldReports</span> <span class="o">=</span> <span class="p">[]</span>
          <span class="n">changes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">newReports</span><span class="p">)</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">oldReports</span><span class="p">))</span>
          <span class="k">if</span> <span class="n">changes</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">():</span>  <span class="c1">#If there&#39;s new changes in the folder</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Report folder change detected&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_report</span><span class="p">()</span>
            <span class="n">oldReports</span> <span class="o">=</span> <span class="n">newReports</span>
          <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">oldReports</span> <span class="o">=</span> <span class="p">[]</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">refresh_report</span><span class="p">()</span>
          <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">watchReports</span><span class="p">)</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>


<div class="viewcode-block" id="ctqa_client.open_reports_folder"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.open_reports_folder">[docs]</a>  <span class="k">def</span> <span class="nf">open_reports_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">reportsLocation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForFolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reportspath</span><span class="p">,</span> <span class="s1">&#39;Report&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reportsLocation</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
          <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">reportsLocation</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
          <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">reportsLocation</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;xdg-open&quot;</span><span class="p">,</span> <span class="n">reportsLocation</span><span class="p">])</span></div>

  
<div class="viewcode-block" id="ctqa_client.open_report"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.open_report">[docs]</a>  <span class="k">def</span> <span class="nf">open_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">rlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replist</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">rlist</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">rlist</span><span class="o">.</span><span class="n">focus</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
      <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">reportsLocation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForFolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reportspath</span><span class="p">,</span> <span class="s1">&#39;Report&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">reportsLocation</span><span class="p">:</span>
        <span class="n">reportPath</span> <span class="o">=</span> <span class="n">reportsLocation</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">reportPath</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
              <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">reportPath</span><span class="p">)</span>
          <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
              <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">reportPath</span><span class="p">])</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;xdg-open&quot;</span><span class="p">,</span> <span class="n">reportPath</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Report Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Report does not exist at:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">reportPath</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.load_log_contents"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.load_log_contents">[docs]</a>  <span class="k">def</span> <span class="nf">load_log_contents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logpath</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
      <span class="n">d</span><span class="o">=</span><span class="n">deque</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>
      <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.refresh_log"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.refresh_log">[docs]</a>  <span class="k">def</span> <span class="nf">refresh_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">load_log_contents</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.start_log_watcher"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.start_log_watcher">[docs]</a>  <span class="k">def</span> <span class="nf">start_log_watcher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">watchLog</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
      <span class="n">lw</span> <span class="o">=</span> <span class="n">logwatcher</span><span class="o">.</span><span class="n">LogWatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
      <span class="n">lw</span><span class="o">.</span><span class="n">loop</span><span class="p">()</span>
    <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">watchLog</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_watcher_callback</span><span class="p">,))</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">thread</span></div>

<div class="viewcode-block" id="ctqa_client.log_watcher_callback"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.log_watcher_callback">[docs]</a>  <span class="k">def</span> <span class="nf">log_watcher_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logText</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.open_log"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.open_log">[docs]</a>  <span class="k">def</span> <span class="nf">open_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">logExists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logpath</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">logExists</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
          <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logpath</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
          <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpath</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;xdg-open&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpath</span><span class="p">])</span></div>


<div class="viewcode-block" id="ctqa_client.open_log_folder"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.open_log_folder">[docs]</a>  <span class="k">def</span> <span class="nf">open_log_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">logLocation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForFolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="s1">&#39;Log&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">logLocation</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
          <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">logLocation</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
          <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">logLocation</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;xdg-open&quot;</span><span class="p">,</span> <span class="n">logLocation</span><span class="p">])</span></div>


<div class="viewcode-block" id="ctqa_client.manual_audit"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.manual_audit">[docs]</a>  <span class="k">def</span> <span class="nf">manual_audit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># determine if application is a script file or frozen exe</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;frozen&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
      <span class="n">command</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; --audit --debug&#39;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;python &#39;</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; --audit --debug&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popenAndCall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resetButton</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.resetButton"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.resetButton">[docs]</a>  <span class="k">def</span> <span class="nf">resetButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceRun</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceRun</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Manual Audit&#39;</span><span class="p">)</span></div>
  

<div class="viewcode-block" id="ctqa_client.popenAndCall"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.popenAndCall">[docs]</a>  <span class="k">def</span> <span class="nf">popenAndCall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">onExit</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the given args in a subprocess.Popen, and then calls the function</span>
<span class="sd">    onExit when the subprocess completes.</span>
<span class="sd">    onExit is a callable object, and popenArgs is a list/tuple of args that </span>
<span class="sd">    would give to subprocess.Popen.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">runInThread</span><span class="p">(</span><span class="n">onExit</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">configServiceRun</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Running...&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">configServiceRun</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
      <span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
      <span class="n">proc</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
      <span class="n">onExit</span><span class="p">()</span>
      <span class="k">return</span>
    <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">runInThread</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">onExit</span><span class="p">,</span> <span class="n">command</span><span class="p">))</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="c1"># returns immediately after the thread starts</span>
    <span class="k">return</span> <span class="n">thread</span></div>


<div class="viewcode-block" id="ctqa_client.open_config_client"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.open_config_client">[docs]</a>  <span class="k">def</span> <span class="nf">open_config_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">Toplevel</span><span class="p">()</span>
    <span class="n">configclient</span><span class="o">.</span><span class="n">config_client</span><span class="p">(</span><span class="n">top</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.open_profile_client"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.open_profile_client">[docs]</a>  <span class="k">def</span> <span class="nf">open_profile_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">Toplevel</span><span class="p">()</span>
    <span class="n">profileclient</span><span class="o">.</span><span class="n">profile_client</span><span class="p">(</span><span class="n">top</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.open_credentials_client"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.open_credentials_client">[docs]</a>  <span class="k">def</span> <span class="nf">open_credentials_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">Toplevel</span><span class="p">()</span>
    <span class="n">notificationsclient</span><span class="o">.</span><span class="n">notifications_client</span><span class="p">(</span><span class="n">top</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.service_install"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.service_install">[docs]</a>  <span class="k">def</span> <span class="nf">service_install</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Attempt a service manager install</span>
    <span class="n">servicemanager</span><span class="o">.</span><span class="n">install</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceInst</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Uninstall Service&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceInst</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_uninstall</span><span class="p">)</span></div>


<div class="viewcode-block" id="ctqa_client.service_uninstall"><a class="viewcode-back" href="../../../ctqa.gui.html#ctqa.gui.client.ctqa_client.service_uninstall">[docs]</a>  <span class="k">def</span> <span class="nf">service_uninstall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Attempt to uninstall service</span>
    <span class="n">servicemanager</span><span class="o">.</span><span class="n">uninstall</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceInst</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Install Service&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configServiceInst</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_install</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Reece Walsh

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>